<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Tokyo 2026 🖍️ | 東京大冒險</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@500;700;800;900&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['"M PLUS Rounded 1c"', 'sans-serif'] },
          colors: { 
            draw: { bg: '#FDFCF8', ink: '#2B2D42', yellow: '#FFD166', pink: '#EF476F', blue: '#118AB2', green: '#06D6A0', muted: '#6C757D' } 
          },
          boxShadow: { 
            'solid': '3px 3px 0px 0px #2B2D42', 
            'solid-sm': '2px 2px 0px 0px #2B2D42',
            'floating': '0 12px 35px rgba(43, 45, 66, 0.18)'
          }
        }
      }
    }
  </script>
  <style>
    body { background-color: #FDFCF8; -webkit-tap-highlight-color: transparent; overscroll-behavior-y: none; color: #2B2D42; }
    
    /* 質感點陣背景 */
    body::before { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: radial-gradient(#E8E8E8 1.5px, transparent 1.5px); background-size: 24px 24px; z-index: -1; pointer-events: none; }
    
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    
    .fade-in { animation: fadeIn 0.3s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
    
    .click-effect { transition: transform 0.1s, box-shadow 0.1s; }
    .click-effect:active { transform: translate(2px, 2px); box-shadow: 1px 1px 0px 0px #2B2D42 !important; }
    
    /* 🔥 圖片完美防裁切畫框：外層黑框 + 內層留白 padding，圖片等比縮放不變形 */
    .img-frame {
        background-color: #ffffff;
        border: 2px solid #2B2D42;
        border-radius: 16px;
        padding: 6px; 
        box-shadow: 2px 2px 0px 0px #2B2D42;
        margin-top: 12px;
        margin-bottom: 8px;
    }
    .img-frame img {
        width: 100%;
        max-height: 220px;
        object-fit: contain; /* 保證圖片比例完美，絕不裁切 */
        border-radius: 8px;
        cursor: zoom-in;
        display: block;
        background-color: #f8fafc;
    }
    
    details > summary { list-style: none; outline: none; }
    details > summary::-webkit-details-marker { display: none; }
    
    /* 為懸浮導覽列預留充足的底部空間 */
    .pb-safe { padding-bottom: calc(110px + env(safe-area-inset-bottom)); }
  </style>
</head>
<body class="font-sans h-screen flex flex-col m-0 p-0 overflow-hidden">

  <header class="pt-12 pb-3 px-5 flex justify-between items-end shrink-0 z-20 relative">
    <div>
      <h1 class="text-3xl font-black tracking-wide">Tokyo 2026</h1>
      <p class="text-[11px] font-bold text-draw-pink mt-1 bg-white border-2 border-draw-ink shadow-solid-sm inline-block px-3 py-1 rounded-full">東京大冒險 🇯🇵</p>
    </div>
    <div class="bg-draw-yellow text-draw-ink border-2 border-draw-ink shadow-solid-sm px-3 py-1.5 rounded-xl font-black flex items-center">
      <i class="fa-solid fa-calendar-day mr-2"></i><span class="text-xs">3/12 - 3/17</span>
    </div>
  </header>

  <main class="flex-1 overflow-y-auto no-scrollbar pb-safe relative z-10 w-full px-4 pt-2" id="main-content">
      
    <section id="tab-plan" class="fade-in space-y-5">
      
      <div class="flex overflow-x-auto no-scrollbar space-x-2.5 py-2 sticky top-0 z-30 -mx-4 px-4 pb-4" style="background: linear-gradient(to bottom, #FDFCF8 75%, rgba(253,252,248,0.8) 90%, transparent);">
        <button onclick="showDay(1)" id="btn-d1" class="day-btn bg-draw-pink text-white border-2 border-draw-ink shadow-solid-sm shrink-0 w-[4.5rem] py-2 rounded-xl font-black text-sm transition-all">D1</button>
        <button onclick="showDay(2)" id="btn-d2" class="day-btn bg-white text-draw-ink border-2 border-draw-ink shadow-solid-sm shrink-0 w-[4.5rem] py-2 rounded-xl font-black text-sm transition-all">D2</button>
        <button onclick="showDay(3)" id="btn-d3" class="day-btn bg-white text-draw-ink border-2 border-draw-ink shadow-solid-sm shrink-0 w-[4.5rem] py-2 rounded-xl font-black text-sm transition-all">D3</button>
        <button onclick="showDay(4)" id="btn-d4" class="day-btn bg-white text-draw-ink border-2 border-draw-ink shadow-solid-sm shrink-0 w-[4.5rem] py-2 rounded-xl font-black text-sm transition-all">D4</button>
        <button onclick="showDay(5)" id="btn-d5" class="day-btn bg-white text-draw-ink border-2 border-draw-ink shadow-solid-sm shrink-0 w-[4.5rem] py-2 rounded-xl font-black text-sm transition-all">D5</button>
        <button onclick="showDay(6)" id="btn-d6" class="day-btn bg-white text-draw-ink border-2 border-draw-ink shadow-solid-sm shrink-0 w-[4.5rem] py-2 rounded-xl font-black text-sm transition-all">D6</button>
      </div>

      <div id="day-1" class="day-content fade-in space-y-4">
        <ul class="space-y-6 relative border-l-2 border-draw-ink ml-3 pl-5 py-2">
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-yellow border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2"><i class="fa-solid fa-plane-departure text-draw-blue mr-1"></i> 航班與出發</h3>
                    <p class="text-xs font-bold text-draw-muted mb-2"><span class="bg-draw-yellow text-draw-ink px-2 py-0.5 rounded-lg border-2 border-draw-ink mr-1 font-black">03:30</span> 機場接送</p>
                    <p class="text-xs font-bold text-draw-muted mb-3"><span class="bg-draw-pink text-white px-2 py-0.5 rounded-lg border-2 border-draw-ink mr-1 font-black">06:40</span> 搭乘 TR898 飛往成田 (NRT)</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=桃園國際機場" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-blue mr-1.5"></i> 桃園機場 Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-1">🚌 利木津巴士 直達飯店</h3>
                    <div class="img-frame">
                        <img src="https://biglocal.github.io/tokyo2026/%E6%88%AA%E5%9C%96%202026-02-22%20%E6%99%9A%E4%B8%8A8.03.44.png?raw=true" onclick="openImg(this.src)" alt="巴士時刻表">
                    </div>
                    <p class="text-[10px] text-center font-bold text-draw-muted">👆 點擊時刻表可放大</p>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2"><i class="fa-solid fa-utensils text-draw-green mr-1"></i> 伊克斯皮兒莉 (Ikspiari) 午餐</h3>
                    <div class="mb-2">
                        <span class="bg-gray-800 text-white px-2 py-1 rounded-lg border-2 border-draw-ink text-[10px] font-black shadow-sm">一蘭拉麵在附近</span>
                    </div>
                    <p class="text-xs font-bold text-draw-muted leading-relaxed mb-3">大型歐風商場，六個人在這裡找間寬敞的餐廳解決午餐最為舒適。</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=Ikspiari+伊克斯皮兒莉" target="_blank" class="inline-flex items-center bg-draw-green text-white px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot mr-1.5"></i> 開啟 Google Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-green border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2"><i class="fa-solid fa-hotel text-draw-yellow mr-1"></i> Check-in 迪士尼飯店</h3>
                    <p class="text-xs font-bold text-draw-muted mb-3"><span class="bg-draw-green text-white px-2 py-0.5 rounded-lg border-2 border-draw-ink mr-1 font-black">15:00</span> 入住玩具總動員飯店</p>
                    <p class="text-xs font-bold text-draw-ink leading-relaxed">視體力決定是否購買傍晚票進樂園，看夜間遊行與煙火 🎆</p>
                    <div class="mt-3 mb-3 bg-pink-50 p-3 rounded-xl border-2 border-dashed border-draw-pink text-[10px] font-bold text-draw-ink leading-relaxed">
                        <strong class="text-draw-pink">傍晚票價參考：</strong><br>平日 17:00 起：¥4,500 - ¥6,200<br>假日 15:00 起：¥6,500 - ¥8,700
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=東京迪士尼度假區玩具總動員飯店" target="_blank" class="inline-flex items-center bg-draw-blue text-white px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot mr-1.5"></i> 飯店 Map</a>
                </div>
            </li>
        </ul>
      </div>

      <div id="day-2" class="day-content hidden fade-in space-y-4">
        <ul class="space-y-6 relative border-l-2 border-draw-ink ml-3 pl-5 py-2">
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-pink border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-pink text-sm mb-2"><i class="fa-solid fa-wand-magic-sparkles mr-1"></i> Disney Land 夢幻全日</h3>
                    <p class="text-xs font-bold text-draw-muted mb-2">Happy Entry 通常 <span class="bg-draw-pink text-white px-1 rounded font-black">08:30-08:45</span> 放人，<strong class="text-draw-ink">請務必 8 點前到</strong>。</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=東京迪士尼樂園" target="_blank" class="inline-flex items-center bg-draw-pink text-white px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect mb-3"><i class="fa-solid fa-map-location-dot mr-1.5"></i> 樂園 Map</a>
                    
                    <div class="img-frame">
                        <img src="https://biglocal.github.io/tokyo2026/%E6%88%AA%E5%9C%96%202026-02-22%20%E4%B8%8B%E5%8D%883.23.20.png" onclick="openImg(this.src)" alt="入園地圖">
                    </div>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-3">🎯 必玩設施攻略</h3>
                    <div class="flex flex-wrap gap-2">
                        <span class="bg-white px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-xs font-black">🌹 美女與野獸</span>
                        <span class="bg-white px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-xs font-black">💦 飛濺山</span>
                        <span class="bg-white px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-xs font-black">🚂 巨雷山</span>
                    </div>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-blue border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-blue text-sm mb-1">🎉 遊行路線圖</h3>
                    <div class="img-frame">
                        <img src="https://biglocal.github.io/tokyo2026/%E6%88%AA%E5%9C%96%202026-02-22%20%E4%B8%8B%E5%8D%883.23.32.png" onclick="openImg(this.src)" alt="遊行路線">
                    </div>
                </div>
            </li>
        </ul>
      </div>

      <div id="day-3" class="day-content hidden fade-in space-y-4">
        <div class="bg-draw-yellow border-2 border-draw-ink shadow-solid rounded-2xl p-4 text-center mx-1">
            <h3 class="font-black text-draw-ink text-sm mb-3"><i class="fa-solid fa-map-location-dot mr-1"></i> 原宿 / 表參道 散步地圖</h3>
            <div class="bg-[#FDFCF8] border-2 border-draw-ink rounded-xl h-48 relative overflow-hidden text-[10px] font-black shadow-inner">
                <div class="absolute top-[45%] w-full border-t-4 border-dashed border-[#d1d5db]"></div>
                <div class="absolute left-[35%] h-full border-l-4 border-dashed border-[#d1d5db]"></div>
                <span class="absolute top-[36%] right-2 text-gray-400">表參道</span>
                <span class="absolute bottom-2 left-[38%] text-gray-400">明治通/貓街</span>
                
                <div class="absolute top-2 left-2"><span class="bg-gray-800 text-white px-2 py-1 rounded-lg border-2 border-draw-ink shadow-sm">一蘭拉麵</span></div>
                <div class="absolute top-4 right-4"><span class="bg-green-400 text-white px-2 py-1 rounded-lg border-2 border-draw-ink shadow-sm">Human Made</span></div>
                <div class="absolute bottom-4 left-2"><span class="bg-pink-400 text-white px-2 py-1 rounded-lg border-2 border-draw-ink shadow-sm">Chanel</span></div>
                <div class="absolute bottom-4 right-4"><span class="bg-yellow-400 text-draw-ink px-2 py-1 rounded-lg border-2 border-draw-ink shadow-sm">Vivienne W.</span></div>
                <div class="absolute top-[45%] left-[60%] transform -translate-x-1/2 -translate-y-1/2 mt-3"><span class="bg-blue-400 text-white px-2 py-1 rounded-lg border-2 border-draw-ink shadow-sm">Rolex</span></div>
                <div class="absolute top-[65%] left-[30%]"><span class="bg-red-400 text-white px-2 py-1 rounded-lg border-2 border-draw-ink shadow-sm">LUKE'S LOBSTER</span></div>
            </div>
        </div>

        <ul class="space-y-6 relative border-l-2 border-draw-ink ml-3 pl-5 py-2 mt-4">
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-pink border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🐾 豪德寺 (招福貓)</h3>
                    <p class="text-xs font-bold text-draw-muted mb-2"><span class="bg-draw-yellow text-draw-ink px-2 py-0.5 rounded-lg border-2 border-draw-ink mr-1 font-black">08:30</span> 出發</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=豪德寺" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-pink mr-1.5"></i> 豪德寺 Map</a>
                    <div class="img-frame">
                        <img src="https://biglocal.github.io/tokyo2026/day3_cat.png" onclick="openImg(this.src)" alt="豪德寺">
                    </div>
                    <a href="https://tokyo.letsgojp.com/archives/762222/" target="_blank" class="inline-block mt-1 text-[10px] bg-draw-blue text-white px-4 py-2 rounded-xl border-2 border-draw-ink shadow-solid-sm click-effect font-black"><i class="fa-solid fa-link mr-1"></i> 查看豪德寺圖文攻略</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🛍️ 原宿 ➔ 青山 / 表參道</h3>
                    <p class="text-[10px] font-bold text-draw-blue bg-blue-50 px-2 py-1 rounded-lg border border-blue-200 inline-block mb-3"><i class="fa-solid fa-train mr-1"></i> 交通大約抓 30 分鐘</p>
                    <div class="flex flex-wrap gap-2 mb-3">
                        <span class="bg-pink-200 px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">Chanel</span>
                        <span class="bg-yellow-200 px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">Vivienne W.</span>
                        <span class="bg-green-200 px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">Human Made</span>
                        <span class="bg-blue-200 text-white px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">Rolex</span>
                        <span class="bg-gray-800 text-white px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">一蘭拉麵</span>
                    </div>
                    <div class="bg-pink-50 p-3 rounded-xl border-2 border-draw-ink mb-3">
                        <p class="text-xs font-bold text-draw-pink mb-2"><i class="fa-solid fa-utensils mr-1"></i> 美食：LUKE'S LOBSTER 表參道貓街店</p>
                        <a href="https://www.google.com/maps/search/?api=1&query=LUKE'S+LOBSTER+表參道貓街店" target="_blank" class="inline-flex items-center bg-white text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-red-500 mr-1.5"></i> 龍蝦堡 Map</a>
                    </div>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🏓 唐橋桌球 (代代木)</h3>
                    <p class="text-xs font-bold text-draw-muted mb-2">營業時間：10:00 - 19:00</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=唐橋卓球+代代木店" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-green mr-1.5"></i> 桌球店 Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🌃 澀谷 & 涉谷夜景</h3>
                    <p class="text-xs font-bold text-draw-muted mb-2">預約前往 SHIBUYA SKY 欣賞百萬夜景。</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=SHIBUYA+SKY" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-blue mr-1.5"></i> 澀谷天空 Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-ink border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🚗 取車與休息</h3>
                    <p class="text-xs font-bold text-draw-muted mb-2"><span class="bg-draw-ink text-white px-2 py-0.5 rounded-lg mr-1 font-black">20:00</span> 吾妻橋店取車，隨後回民宿。</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=トヨタレンタカー+吾妻橋店" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-ink mr-1.5"></i> TOYOTA 取車 Map</a>
                </div>
            </li>
        </ul>
      </div>

      <div id="day-4" class="day-content hidden fade-in space-y-4">
        <div class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl p-2 h-64 overflow-hidden mx-1">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d103983.84074212513!2d138.68339174665478!3d35.500994192661556!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60195e783457aeb1%3A0xc4f44fa6d8f28d8!2z5rKz5Y-j5rmW!5e0!3m2!1szh-TW!2stw!4v1709123456789!5m2!1szh-TW!2stw" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy" class="rounded-xl border-2 border-draw-ink pointer-events-none"></iframe>
        </div>

        <ul class="space-y-6 relative border-l-2 border-draw-ink ml-3 pl-5 py-2 mt-5">
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-green border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🗻 驅車前往河口湖</h3>
                    <p class="text-xs font-bold text-draw-muted mb-3"><span class="bg-draw-yellow text-draw-ink px-2 py-0.5 rounded-lg border-2 border-draw-ink mr-1 font-black">06:30</span> 早起出發，記得帶好國際駕照！</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=河口湖" target="_blank" class="inline-flex items-center bg-draw-green text-white px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot mr-1.5"></i> 河口湖 Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🍜 晚餐：AFURI 拉麵</h3>
                    <p class="text-xs font-bold text-draw-muted mb-3">南町田 Grandberry Park店，來碗清爽的柚子鹽拉麵。</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=AFURI+南町田グランベリーパーク" target="_blank" class="inline-flex items-center bg-white text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-yellow mr-1.5"></i> AFURI Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-ink border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🚗 還車</h3>
                    <p class="text-xs font-bold text-draw-muted mb-3">加滿油後於吾妻橋店還車，結束今日自駕。</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=トヨタレンタカー+吾妻橋店" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-ink mr-1.5"></i> TOYOTA 還車 Map</a>
                </div>
            </li>
        </ul>
      </div>

      <div id="day-5" class="day-content hidden fade-in space-y-4">
        <div class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl p-5 flex justify-between items-center text-center font-black text-[11px] mx-1 mb-6">
            <div><i class="fa-solid fa-torii-gate text-draw-pink text-3xl mb-2"></i><br>淺草寺</div>
            <i class="fa-solid fa-arrow-right text-gray-300"></i>
            <div><i class="fa-solid fa-gamepad text-draw-blue text-3xl mb-2"></i><br>秋葉原</div>
            <i class="fa-solid fa-arrow-right text-gray-300"></i>
            <div><i class="fa-solid fa-train text-draw-green text-3xl mb-2"></i><br>東京站</div>
            <i class="fa-solid fa-arrow-right text-gray-300"></i>
            <div><i class="fa-solid fa-gem text-draw-yellow text-3xl mb-2"></i><br>銀座</div>
        </div>
        
        <ul class="space-y-6 relative border-l-2 border-draw-ink ml-3 pl-5 py-2">
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-3">🏮 淺草寺</h3>
                    <a href="https://www.google.com/maps/search/?api=1&query=淺草寺" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-pink mr-1.5"></i> 淺草寺 Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-3">👾 秋葉原</h3>
                    <a href="https://www.google.com/maps/search/?api=1&query=秋葉原" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-blue mr-1.5"></i> 秋葉原 Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-3">🚉 東京車站</h3>
                    <a href="https://www.google.com/maps/search/?api=1&query=東京車站" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-green mr-1.5"></i> 東京車站 Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-3">💎 銀座精品巡禮</h3>
                    <p class="text-[10px] font-bold text-draw-blue bg-blue-50 px-2 py-1 rounded-lg border border-blue-200 inline-block mb-3"><i class="fa-solid fa-train"></i> 各點交通大約標註 15 分鐘</p>
                    <div class="flex flex-wrap gap-2 mb-3">
                        <span class="bg-pink-200 px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">Chanel</span>
                        <span class="bg-yellow-200 px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">Vivienne W.</span>
                        <span class="bg-green-200 px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">Human Made</span>
                        <span class="bg-blue-200 text-white px-2 py-0.5 rounded-lg border border-black text-[10px] font-black shadow-sm">Rolex</span>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=銀座" target="_blank" class="inline-flex items-center bg-draw-yellow text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot mr-1.5"></i> 銀座 Map</a>
                </div>
            </li>
        </ul>
      </div>

      <div id="day-6" class="day-content hidden fade-in space-y-4">
        <ul class="space-y-6 relative border-l-2 border-draw-ink ml-3 pl-5 py-2">
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🧳 準備返家</h3>
                    <p class="text-xs font-bold text-draw-muted mb-3"><span class="bg-draw-yellow text-draw-ink px-2 py-0.5 rounded-lg border-2 border-draw-ink mr-1 font-black">09:00</span> 起床整理，機場接送前往成田。</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=成田國際機場" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-blue mr-1.5"></i> 成田機場 Map</a>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-white border-2 border-draw-ink rounded-full z-10"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">✈️ 航班起飛</h3>
                    <p class="text-xs font-bold text-draw-muted"><span class="bg-draw-pink text-white px-2 py-0.5 rounded-lg border-2 border-draw-ink mr-1 font-black">13:45</span> 搭乘 JX801 (NRT T2 ➔ TPE)</p>
                </div>
            </li>
            <li class="relative">
                <div class="absolute -left-[27.5px] top-1.5 w-3.5 h-3.5 bg-draw-ink border-2 border-draw-ink rounded-full z-10 shadow-solid-sm"></div>
                <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4">
                    <h3 class="font-black text-draw-ink text-sm mb-2">🏡 抵達台灣</h3>
                    <p class="text-xs font-bold text-draw-muted mb-3"><span class="bg-draw-ink text-white px-2 py-0.5 rounded-lg border-2 border-draw-ink mr-1 font-black">16:50</span> 抵達機場，搭乘專車平安回家。</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=桃園國際機場" target="_blank" class="inline-flex items-center bg-gray-100 text-draw-ink px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-sm text-[10px] font-black click-effect"><i class="fa-solid fa-map-location-dot text-draw-green mr-1.5"></i> 桃園機場 Map</a>
                </div>
            </li>
        </ul>
      </div>
    </section>

    <section id="tab-guide" class="hidden fade-in space-y-4 mt-2">
      <h2 class="font-black text-xl mb-3"><i class="fa-solid fa-book-open text-draw-yellow mr-2"></i> 深度導覽</h2>
      
      <details class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl group outline-none overflow-hidden">
        <summary class="font-black p-4 border-b-2 border-transparent group-open:border-draw-ink cursor-pointer flex justify-between items-center bg-pink-50 transition-colors">
          <span>🛍️ 逛街戰術分析</span><i class="fa-solid fa-chevron-down transition-transform group-open:rotate-180"></i>
        </summary>
        <div class="p-4 text-xs font-bold space-y-3 bg-white leading-relaxed">
          <p><span class="bg-pink-200 px-2 py-0.5 rounded border border-black text-black inline-block w-full mb-1 text-center">Chanel</span> 銀座旗艦店貨源較足，表參道店建築很美值得一看。</p>
          <p><span class="bg-yellow-200 px-2 py-0.5 rounded border border-black text-black inline-block w-full mb-1 text-center">Vivienne Westwood</span> 青山旗艦店款式獨特；銀座店隱身於 GINZA SIX 內。</p>
          <p><span class="bg-green-200 px-2 py-0.5 rounded border border-black text-black inline-block w-full mb-1 text-center">Human Made</span> 原宿店為潮流聖地，常須排隊；銀座可前往 Dover Street Market (DSM)。</p>
          <p><span class="bg-blue-200 px-2 py-0.5 rounded border border-black text-white inline-block w-full mb-1 text-center">Rolex</span> 採不定期進貨，熱門運動款全看運氣，建議經過就進去問。</p>
          <p><span class="bg-gray-800 px-2 py-0.5 rounded border border-black text-white inline-block w-full mb-1 text-center">一蘭拉麵</span> 原宿店位於神宮前，逛累了隨時補充體力。</p>
        </div>
      </details>

      <details class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl group outline-none overflow-hidden">
        <summary class="font-black p-4 border-b-2 border-transparent group-open:border-draw-ink cursor-pointer flex justify-between items-center bg-blue-50 transition-colors">
          <span>🗻 河口湖 推薦景點</span><i class="fa-solid fa-chevron-down transition-transform group-open:rotate-180"></i>
        </summary>
        <div class="p-4 text-xs font-bold space-y-3 bg-white">
          <li class="list-none flex items-start"><i class="fa-solid fa-location-dot text-draw-pink mt-1 mr-2 text-sm"></i><div><strong class="text-draw-blue text-sm">新倉山淺間公園</strong><br>經典的五重塔與富士山同框絕景，需爬一段階梯。</div></li>
          <li class="list-none flex items-start"><i class="fa-solid fa-location-dot text-draw-pink mt-1 mr-2 text-sm"></i><div><strong class="text-draw-blue text-sm">大石公園</strong><br>位於湖畔，有平坦的步道與四季花卉。</div></li>
          <li class="list-none flex items-start"><i class="fa-solid fa-location-dot text-draw-pink mt-1 mr-2 text-sm"></i><div><strong class="text-draw-blue text-sm">下吉田商店街</strong><br>知名網紅拍照路口，拍照時<strong class="text-red-500">務必注意來車，遵守交通規則</strong>。</div></li>
        </div>
      </details>

      <details class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl group outline-none overflow-hidden">
        <summary class="font-black p-4 border-b-2 border-transparent group-open:border-draw-ink cursor-pointer flex justify-between items-center bg-yellow-50 transition-colors">
          <span>✨ teamLab Planets 攻略</span><i class="fa-solid fa-chevron-down transition-transform group-open:rotate-180"></i>
        </summary>
        <div class="p-4 text-xs font-bold space-y-3 bg-white text-center">
          <p class="text-left bg-gray-50 p-4 rounded-xl border-2 border-dashed border-gray-300 leading-relaxed">主打「身臨其境」的五感體驗。館內部分區域需要涉水（水深約至小腿），強烈建議穿著短褲或容易捲起褲管的服裝。現場可免費借用手機防水袋。</p>
          <a href="https://lovetogo.tw/202501-tokyo/teamlab-planets/index.php" target="_blank" class="inline-block bg-draw-blue text-white px-5 py-3 rounded-xl border-2 border-draw-ink shadow-solid-sm click-effect mt-2 w-full text-sm"><i class="fa-solid fa-link mr-1"></i> 查看詳細圖文導覽</a>
        </div>
      </details>

      <div class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl p-3 mt-4">
        <p class="font-black text-sm mb-2 ml-1"><i class="fa-solid fa-map text-draw-green mr-1"></i> 迪士尼園區周邊地圖</p>
        <div class="rounded-xl border-2 border-draw-ink overflow-hidden h-56">
          <iframe width="100%" height="100%" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://www.openstreetmap.org/export/embed.html?bbox=139.8732%2C35.6263%2C139.8892%2C35.6373&layer=mapnik"></iframe>
        </div>
      </div>
    </section>

    <section id="tab-wallet" class="hidden fade-in space-y-5 mt-2">
      <div class="bg-draw-green text-draw-ink border-2 border-draw-ink shadow-solid rounded-2xl p-5 flex justify-between items-center relative overflow-hidden">
        <i class="fa-solid fa-yen-sign absolute -right-2 -bottom-6 text-7xl text-white opacity-30"></i>
        <div class="relative z-10">
          <p class="text-[10px] font-black mb-1 bg-white px-2 py-0.5 rounded inline-block border-2 border-draw-ink">設定匯率</p>
          <div class="flex items-center gap-2 mt-1">
            <span class="font-black text-sm text-white drop-shadow-md">1 JPY =</span>
            <input type="number" id="rate-input" value="0.21" step="0.001" class="w-20 px-2 py-1.5 rounded-lg border-2 border-draw-ink font-black text-sm outline-none text-center">
            <span class="font-black text-sm text-white drop-shadow-md">TWD</span>
          </div>
        </div>
        <div class="text-right relative z-10">
          <p class="text-[10px] font-black bg-black text-white px-2 py-0.5 rounded inline-block mb-1 border-2 border-black shadow-sm">台幣總花費</p>
          <p id="total-twd" class="text-2xl font-black text-white drop-shadow-md">NT$ 0</p>
        </div>
      </div>

      <div class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl p-5 space-y-4">
        <h3 class="font-black text-sm border-b-2 border-dashed border-gray-300 pb-2"><i class="fa-solid fa-coins text-draw-yellow mr-1 text-lg"></i> 記一筆花費</h3>
        
        <input type="text" id="exp-name" placeholder="買了什麼？ (例: 恐龍扭蛋)" class="w-full bg-gray-50 border-2 border-draw-ink rounded-xl p-3.5 text-sm font-bold outline-none focus:bg-white transition-colors">
        
        <div class="relative">
          <input type="text" id="exp-jpy" placeholder="日幣金額 (支援算式如 500+200*3)" class="w-full bg-gray-50 border-2 border-draw-ink rounded-xl p-3.5 text-sm font-bold outline-none focus:bg-white transition-colors pr-10">
          <span class="absolute right-4 top-4 font-black text-draw-pink text-base">¥</span>
        </div>
        
        <div class="flex gap-3 pt-1">
          <input type="file" id="exp-img" accept="image/*" capture="environment" class="hidden" onchange="previewImg(event)">
          <label for="exp-img" class="flex-1 bg-draw-blue text-white text-center rounded-xl p-3 border-2 border-draw-ink shadow-solid-sm click-effect text-xs font-black cursor-pointer flex flex-col justify-center items-center"><i class="fa-solid fa-camera mb-1 text-base"></i>拍照/上傳</label>
          <button onclick="addExpense()" class="flex-1 bg-draw-pink text-white text-center rounded-xl p-3 border-2 border-draw-ink shadow-solid-sm click-effect text-xs font-black flex flex-col justify-center items-center"><i class="fa-solid fa-piggy-bank mb-1 text-base"></i>存入撲滿</button>
        </div>
        
        <div id="img-preview-box" class="hidden relative w-full h-32 border-2 border-draw-ink rounded-xl overflow-hidden mt-2 bg-gray-100">
          <img id="img-preview" src="" class="w-full h-full object-contain">
          <button onclick="removePreview()" class="absolute top-0 right-0 bg-red-500 text-white w-8 h-8 flex items-center justify-center text-sm border-l-2 border-b-2 border-draw-ink rounded-bl-xl"><i class="fa-solid fa-times"></i></button>
        </div>
      </div>

      <div id="expense-list" class="space-y-4 pb-4">
        </div>
    </section>

    <section id="tab-lists" class="hidden fade-in space-y-5 mt-2">
      <div class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl p-5">
        <h3 class="font-black text-sm mb-3 border-b-2 border-dashed border-gray-300 pb-2"><i class="fa-solid fa-clipboard-check text-draw-green mr-1 text-lg"></i> 行前準備 CheckList</h3>
        <div id="checklist-box" class="space-y-1 text-sm font-bold mt-3">
          </div>
      </div>

      <div class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl p-5">
        <h3 class="font-black text-sm mb-3 border-b-2 border-dashed border-gray-300 pb-2"><i class="fa-solid fa-pen text-draw-pink mr-1 text-lg"></i> 個人備忘錄</h3>
        <textarea id="memo-input" rows="5" class="w-full bg-gray-50 border-2 border-draw-ink rounded-xl p-4 text-sm font-bold outline-none mb-3 focus:bg-white transition-colors" placeholder="在此輸入文字，若是貼上網址會自動轉換為點擊按鈕喔..."></textarea>
        <button onclick="saveMemo()" class="w-full bg-draw-yellow text-draw-ink border-2 border-draw-ink shadow-solid-sm rounded-xl py-3.5 font-black text-sm click-effect w-full"><i class="fa-solid fa-save mr-1"></i> 儲存備忘錄</button>
        <div id="memo-display" class="mt-4 text-xs font-bold leading-relaxed hidden bg-gray-50 p-4 border-2 border-dashed border-gray-300 rounded-xl break-words"></div>
      </div>
    </section>

    <section id="tab-info" class="hidden fade-in space-y-5 mt-2">
      
      <div class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl p-5 relative mb-5">
        <div class="absolute -top-3 left-4 bg-draw-pink text-white text-[11px] font-black px-4 py-1 border-2 border-draw-ink shadow-sm rounded-lg"><i class="fa-solid fa-bookmark mr-1"></i> 預訂快訊</div>
        <div id="info-sheet-content" class="mt-2 space-y-3">
          <div class="text-center text-draw-muted text-xs animate-pulse py-6 font-bold"><i class="fa-solid fa-spinner fa-spin mr-2"></i>正在從 Google 試算表載入資料...</div>
        </div>
      </div>

      <details class="bg-white border-2 border-draw-ink shadow-solid rounded-2xl group outline-none overflow-hidden" open>
        <summary class="font-black p-4 border-b-2 border-transparent group-open:border-draw-ink cursor-pointer flex justify-between items-center bg-gray-50 transition-colors">
          <span><i class="fa-solid fa-car mr-1 text-draw-blue"></i> 機場接送詳細資訊</span><i class="fa-solid fa-chevron-down transition-transform group-open:rotate-180 text-draw-muted"></i>
        </summary>
        <div class="p-4 text-[11px] font-bold space-y-4 bg-white border-t-2 border-draw-ink">
          <div>
            <span class="bg-draw-yellow px-2 py-1 rounded border-2 border-draw-ink mb-2 inline-block text-black">去程 03/12 (四) 03:30 出發</span>
            <p>送機航班：TR898</p>
            <p>接送地址：新竹市中山路640巷198號</p>
            <p class="text-draw-pink mt-1 bg-pink-50 p-1 inline-block rounded border border-pink-200">車資：$2400 (含轉點+夜間加成)</p>
          </div>
          <div class="border-t-2 border-dashed border-gray-300 pt-3">
            <span class="bg-draw-pink text-white px-2 py-1 rounded border-2 border-draw-ink mb-2 inline-block">回程 03/17 (二) 16:50 抵達</span>
            <p>接機航班：JX801</p>
            <p>下車地址：新竹市中山路640巷198號</p>
            <p class="text-draw-pink mt-1 bg-pink-50 p-1 inline-block rounded border border-pink-200">車資：$2100 (含轉點)</p>
          </div>
          <div class="bg-gray-50 p-3 rounded-xl border-2 border-draw-ink mt-2">
            <p class="text-draw-blue mb-1"><i class="fa-solid fa-id-card"></i> 司機資料 (07)</p>
            <p>司機：史育誠 / 電話：<a href="tel:0937660220" class="underline text-blue-600">0937660220</a></p>
            <p>車型：Hyundai Staria 黑 (RBF-7952)</p>
            <div class="mt-2 text-[10px] text-gray-500 border-t border-gray-200 pt-2 leading-relaxed">
                乘客(6人)：郭語安、陳濬宇、張勻宥、郭顥、陳睿碩、陳季浤<br>行李：28吋×4、登機箱×3
            </div>
          </div>
        </div>
      </details>

      <div class="grid grid-cols-2 gap-4">
        <a href="https://www.jma.go.jp/jma/index.html" target="_blank" class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4 text-center click-effect font-black text-xs flex flex-col items-center justify-center">
            <div class="bg-blue-50 w-12 h-12 rounded-full flex items-center justify-center border-2 border-draw-ink mb-2"><i class="fa-solid fa-cloud-sun text-draw-blue text-xl"></i></div>
            日本氣象廳
        </a>
        <a href="https://www.e-japannavi.com/trans/tokyo_images/mtrmap.pdf" target="_blank" class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-4 text-center click-effect font-black text-xs flex flex-col items-center justify-center">
            <div class="bg-green-50 w-12 h-12 rounded-full flex items-center justify-center border-2 border-draw-ink mb-2"><i class="fa-solid fa-train-subway text-draw-green text-xl"></i></div>
            地鐵地圖 PDF
        </a>
      </div>

      <div class="bg-draw-ink text-white border-2 border-draw-ink shadow-solid rounded-2xl p-5 font-black text-xs">
        <h3 class="text-draw-yellow mb-3 border-b-2 border-gray-600 pb-2 text-sm"><i class="fa-solid fa-phone mr-1"></i> 緊急求救專線 🚨</h3>
        <div class="flex justify-between items-center mb-3"><span>警察局 (報案)</span> <a href="tel:110" class="bg-white text-draw-ink px-4 py-1.5 rounded-lg border-2 border-white click-effect">110</a></div>
        <div class="flex justify-between items-center mb-3"><span>消防・救護車</span> <a href="tel:119" class="bg-draw-pink text-white px-4 py-1.5 rounded-lg border-2 border-draw-pink click-effect">119</a></div>
        <div class="flex justify-between items-center"><span>台北駐日代表處</span> <a href="tel:0332807811" class="bg-white text-draw-ink px-4 py-1.5 rounded-lg border-2 border-white click-effect">03-3280-7811</a></div>
      </div>

      <div class="bg-pink-50 border-2 border-draw-ink shadow-solid rounded-2xl p-5 font-bold text-xs text-draw-ink mb-4">
        <h3 class="font-black text-draw-pink mb-3 border-b-2 border-pink-200 pb-2 text-sm"><i class="fa-solid fa-triangle-exclamation mr-1"></i> 旅遊注意事項</h3>
        <ul class="space-y-3 leading-relaxed">
          <li class="flex items-start"><i class="fa-solid fa-ban text-draw-pink mt-0.5 mr-2 text-sm"></i> <div><span class="bg-white border-2 border-draw-ink px-1.5 py-0.5 rounded text-draw-pink mr-1 font-black shadow-sm text-[10px]">嚴禁</span>攜帶肉類製品(含肉乾、泡麵肉塊)回台。</div></li>
          <li class="flex items-start"><i class="fa-solid fa-volume-xmark text-draw-blue mt-0.5 mr-2 text-sm"></i> <div>日本電車內禁止通話，請將手機設為靜音。</div></li>
          <li class="flex items-start"><i class="fa-solid fa-bottle-droplet text-draw-green mt-0.5 mr-2 text-sm"></i> <div>隨身行李液體，單一容器不可超過 100ml。</div></li>
        </ul>
      </div>

    </section>

  </main>

  <nav class="fixed bottom-5 left-4 right-4 z-50 pointer-events-auto">
    <div class="bg-white border-2 border-draw-ink rounded-full shadow-floating flex justify-around items-center py-2 px-1">
      <button onclick="switchTab('plan', this)" class="nav-btn text-draw-pink flex flex-col items-center w-[20%] transition-transform active:scale-90 relative">
        <div class="nav-icon-box bg-white border-2 border-draw-ink shadow-solid-sm rounded-full w-12 h-12 flex items-center justify-center mb-1 z-10 -mt-6"><i class="fa-solid fa-map-location-dot text-lg"></i></div>
        <span class="text-[10px] font-black mt-0.5">行程</span>
      </button>
      <button onclick="switchTab('guide', this)" class="nav-btn text-draw-muted flex flex-col items-center w-[20%] transition-transform active:scale-90 relative">
        <div class="nav-icon-box border-2 border-transparent rounded-full w-12 h-12 flex items-center justify-center mb-1 z-10"><i class="fa-solid fa-book-open text-lg"></i></div>
        <span class="text-[10px] font-bold mt-0.5">導覽</span>
      </button>
      <button onclick="switchTab('wallet', this)" class="nav-btn text-draw-muted flex flex-col items-center w-[20%] transition-transform active:scale-90 relative">
        <div class="nav-icon-box border-2 border-transparent rounded-full w-12 h-12 flex items-center justify-center mb-1 z-10"><i class="fa-solid fa-wallet text-lg"></i></div>
        <span class="text-[10px] font-bold mt-0.5">記帳</span>
      </button>
      <button onclick="switchTab('lists', this)" class="nav-btn text-draw-muted flex flex-col items-center w-[20%] transition-transform active:scale-90 relative">
        <div class="nav-icon-box border-2 border-transparent rounded-full w-12 h-12 flex items-center justify-center mb-1 z-10"><i class="fa-solid fa-clipboard-check text-lg"></i></div>
        <span class="text-[10px] font-bold mt-0.5">清單</span>
      </button>
      <button onclick="switchTab('info', this)" class="nav-btn text-draw-muted flex flex-col items-center w-[20%] transition-transform active:scale-90 relative">
        <div class="nav-icon-box border-2 border-transparent rounded-full w-12 h-12 flex items-center justify-center mb-1 z-10"><i class="fa-solid fa-circle-info text-lg"></i></div>
        <span class="text-[10px] font-bold mt-0.5">資訊</span>
      </button>
    </div>
  </nav>

  <div id="toast" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-draw-ink text-white text-sm font-black px-6 py-4 rounded-2xl shadow-solid transition-opacity duration-300 opacity-0 pointer-events-none z-[60] flex items-center">
    <i class="fa-solid fa-check-circle text-draw-green mr-2 text-xl"></i> <span id="toast-msg">已儲存</span>
  </div>

  <div id="lightbox" class="hidden fixed inset-0 z-[70] bg-black/95 flex justify-center items-center p-4 transition-opacity" onclick="closeImg()">
    <img id="lightbox-img" src="" class="max-w-full max-h-full object-contain rounded-2xl border-4 border-white shadow-2xl">
    <button class="absolute top-6 right-6 text-white text-3xl hover:text-draw-pink"><i class="fa-solid fa-times"></i></button>
  </div>

  <script>
    /* ========== Navigation & Tabs Logic ========== */
    const TABS = ['plan', 'guide', 'wallet', 'lists', 'info'];
    const COLORS = ['text-draw-pink', 'text-draw-yellow', 'text-draw-green', 'text-draw-blue', 'text-draw-ink'];

    function switchTab(tabId, el) {
      TABS.forEach(t => document.getElementById(`tab-${t}`).classList.add('hidden'));
      document.getElementById(`tab-${tabId}`).classList.remove('hidden');
      
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.className = btn.className.replace(/text-draw-\w+/g, 'text-draw-muted');
        btn.querySelector('span').classList.replace('font-black', 'font-bold');
        let iconBox = btn.querySelector('.nav-icon-box');
        iconBox.classList.remove('bg-white', 'border-draw-ink', 'shadow-solid-sm', '-mt-6');
        iconBox.classList.add('border-transparent');
      });

      el.classList.remove('text-draw-muted');
      el.classList.add(COLORS[TABS.indexOf(tabId)]);
      el.querySelector('span').classList.replace('font-bold', 'font-black');
      let currentIconBox = el.querySelector('.nav-icon-box');
      currentIconBox.classList.remove('border-transparent');
      currentIconBox.classList.add('bg-white', 'border-draw-ink', 'shadow-solid-sm', '-mt-6');
      
      window.scrollTo({top: 0, behavior: 'smooth'});
    }

    function showDay(day) {
      for(let i=1; i<=6; i++) {
        document.getElementById(`day-${i}`).classList.add('hidden');
        let btn = document.getElementById(`btn-d${i}`);
        btn.classList.remove('bg-draw-pink', 'bg-draw-yellow', 'text-white');
        btn.classList.add('bg-white', 'text-draw-ink');
      }
      document.getElementById(`day-${day}`).classList.remove('hidden');
      let target = document.getElementById(`btn-d${day}`);
      target.classList.remove('bg-white', 'text-draw-ink');
      target.classList.add(day===1 ? 'bg-draw-pink' : 'bg-draw-yellow', 'text-white');
    }

    /* ========== Image Lightbox & Toast ========== */
    function openImg(src) {
      document.getElementById('lightbox-img').src = src;
      document.getElementById('lightbox').classList.remove('hidden');
    }
    function closeImg() { document.getElementById('lightbox').classList.add('hidden'); }
    function showToast(msg) {
      const toast = document.getElementById('toast');
      document.getElementById('toast-msg').innerText = msg;
      toast.classList.remove('opacity-0');
      setTimeout(() => toast.classList.add('opacity-0'), 1500);
    }

    /* ========== 1. Google Sheet Fetch (INFO Tab) ========== */
    function loadInfoSheet() {
      const url = `https://docs.google.com/spreadsheets/d/16uetEwwxz6h9jG4iwl64O8KVmk7eFTIgQtOZ95R8Hmc/gviz/tq?tqx=out:json&sheet=fly_cat_hotels`;
      fetch(url)
        .then(r => r.text())
        .then(txt => {
          const json = JSON.parse(txt.substring(txt.indexOf('{'), txt.lastIndexOf('}') + 1));
          const rows = json.table.rows;
          let html = '';
          
          rows.forEach((row, i) => {
            if(row.c && row.c[0] && row.c[0].v) {
              const title = String(row.c[0].v).trim();
              if(title === "標題" || title === "項目名稱" || title === "項目") return;

              let detailsHtml = '';
              for(let j=1; j<row.c.length; j++) {
                  if(row.c[j] && (row.c[j].v || row.c[j].f)) {
                      const val = String(row.c[j].f || row.c[j].v); 
                      if(val.startsWith('http')) {
                          detailsHtml += `<a href="${val}" target="_blank" class="inline-block bg-draw-blue text-white px-4 py-2.5 rounded-xl border-2 border-draw-ink shadow-solid-sm mt-2 text-xs font-black click-effect w-full text-center"><i class="fa-solid fa-link mr-1"></i> 開啟相關連結</a><br>`;
                      } else {
                          detailsHtml += `<p class="mb-2 last:mb-0">${val.replace(/\n/g, '<br>')}</p>`;
                      }
                  }
              }
              if(detailsHtml === '') detailsHtml = '<p class="text-draw-muted text-[10px]">無詳細說明</p>';

              html += `
                <details class="bg-white border-2 border-draw-ink rounded-2xl mb-3 group outline-none overflow-hidden shadow-solid-sm">
                  <summary class="font-black p-4 border-b-2 border-transparent group-open:border-draw-ink cursor-pointer flex justify-between items-center text-draw-ink text-sm transition-colors hover:bg-yellow-50">
                    <span><i class="fa-solid fa-star text-draw-yellow mr-2 text-lg"></i> ${title}</span> 
                    <i class="fa-solid fa-chevron-down transition-transform group-open:rotate-180 text-draw-muted"></i>
                  </summary>
                  <div class="p-4 text-xs bg-gray-50 leading-relaxed break-words text-draw-ink border-t-2 border-draw-ink font-bold">
                    ${detailsHtml}
                  </div>
                </details>`;
            }
          });
          document.getElementById('info-sheet-content').innerHTML = html || '<div class="text-center text-draw-muted text-xs">目前沒有預訂資料喔！</div>';
        })
        .catch(err => {
          document.getElementById('info-sheet-content').innerHTML = '<div class="text-center text-draw-pink text-xs font-bold border-2 border-draw-pink p-3 rounded-xl bg-pink-50"><i class="fa-solid fa-triangle-exclamation mr-1"></i> 預訂快訊載入失敗</div>';
        });
    }

    /* ========== 2. 直接編譯為靜態 HTML 行程 (極致流暢，圖片完美保護) ========== */
    // 我已將指令直接編譯成 D1~D6 的優美靜態標籤，不需再透過 JS 載入。

    /* ========== Wallet (記帳與匯率) ========== */
    let rate = parseFloat(localStorage.getItem('tk26_rate_st')) || 0.21;
    let expenses = JSON.parse(localStorage.getItem('tk26_exp_st')) || [];
    let b64 = null;

    document.getElementById('rate-input').addEventListener('change', function() {
        rate = parseFloat(this.value) || 0.21;
        localStorage.setItem('tk26_rate_st', rate);
        renderExp();
        showToast("匯率已自動儲存！");
    });

    function previewImg(e) {
      const file = e.target.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = function(event) {
        const img = new Image();
        img.onload = function() {
          const canvas = document.createElement('canvas');
          let w = img.width, h = img.height;
          if(w > 500) { h *= 500/w; w = 500; }
          canvas.width = w; canvas.height = h;
          canvas.getContext('2d').drawImage(img, 0, 0, w, h);
          b64 = canvas.toDataURL('image/jpeg', 0.6); 
          document.getElementById('img-preview').src = b64;
          document.getElementById('img-preview-box').classList.remove('hidden');
        };
        img.src = event.target.result;
      };
      reader.readAsDataURL(file);
    }

    function removePreview() {
      b64 = null;
      document.getElementById('exp-img').value = '';
      document.getElementById('img-preview-box').classList.add('hidden');
    }

    function addExpense() {
      const name = document.getElementById('exp-name').value.trim();
      const mathStr = document.getElementById('exp-jpy').value.trim();
      if(!name || !mathStr) return alert("請輸入名稱和金額喔！");
      
      let jpy = 0;
      try { 
        const safeMath = mathStr.replace(/[^0-9+\-*/().]/g, '');
        if(safeMath === "") throw new Error();
        jpy = Math.round(new Function('return ' + safeMath)()); 
      } 
      catch(e) { return alert("金額算式格式錯誤~"); }
      
      expenses.unshift({ 
        id: Date.now(), name, jpy, img: b64, 
        date: new Date().toLocaleDateString('zh-TW', {month:'numeric', day:'numeric', hour:'2-digit', minute:'2-digit'}) 
      });
      localStorage.setItem('tk26_exp_st', JSON.stringify(expenses));
      
      document.getElementById('exp-name').value = '';
      document.getElementById('exp-jpy').value = '';
      removePreview();
      renderExp();
      showToast("金幣存入撲滿！💰");
    }

    function delExp(id) {
      if(confirm("確定要刪除這筆紀錄嗎？")) {
        expenses = expenses.filter(e => e.id !== id);
        localStorage.setItem('tk26_exp_st', JSON.stringify(expenses));
        renderExp();
      }
    }

    function renderExp() {
      document.getElementById('rate-input').value = rate;
      const list = document.getElementById('expense-list');
      let twdTotal = 0;
      
      if(expenses.length === 0) {
        list.innerHTML = '<div class="text-center text-draw-muted text-xs py-10 border-2 border-dashed border-gray-300 rounded-2xl bg-gray-50 font-bold"><i class="fa-solid fa-piggy-bank text-3xl mb-3 text-gray-300 block"></i>還沒有任何花費紀錄喔！</div>';
      } else {
        list.innerHTML = expenses.map(e => {
          const twd = Math.round(e.jpy * rate);
          twdTotal += twd;
          const imgTag = e.img 
            ? `<img src="${e.img}" onclick="openImg(this.src)" class="w-16 h-16 object-cover border-2 border-draw-ink rounded-xl cursor-zoom-in shrink-0">` 
            : `<div class="w-16 h-16 bg-gray-100 border-2 border-draw-ink rounded-xl flex items-center justify-center text-gray-400 shrink-0"><i class="fa-solid fa-receipt text-xl"></i></div>`;
          
          return `
            <div class="bg-white border-2 border-draw-ink shadow-solid-sm rounded-2xl p-3.5 flex gap-3.5 items-center fade-in">
              ${imgTag}
              <div class="flex-1 min-w-0">
                <div class="flex justify-between items-start">
                  <span class="font-black text-sm text-draw-ink truncate pr-2">${e.name}</span> 
                  <button onclick="delExp(${e.id})" class="text-gray-300 hover:text-draw-pink transition-colors px-2"><i class="fa-solid fa-trash text-sm"></i></button>
                </div>
                <div class="flex justify-between items-end mt-1.5">
                  <span class="text-[10px] text-gray-400 font-bold">${e.date}</span>
                  <div class="text-right leading-tight">
                    <span class="block text-[11px] font-black text-draw-muted">¥ ${e.jpy.toLocaleString()}</span> 
                    <span class="block text-sm font-black text-draw-pink mt-0.5">NT$ ${twd.toLocaleString()}</span>
                  </div>
                </div>
              </div>
            </div>`;
        }).join('');
      }
      document.getElementById('total-twd').innerText = `NT$ ${twdTotal.toLocaleString()}`;
    }

    /* ========== LISTS & MEMO ========== */
    const defaultChk = ["護照正本 (效期需滿6個月)", "日幣現金與信用卡 (JCB)", "網卡 / eSIM", "迪士尼門票 / 飯店訂單", "行動電源與充電線", "個人常備藥品", "輕便雨具", "好穿的運動鞋"];
    
    function initLists() {
      const saved = JSON.parse(localStorage.getItem('tk26_chk_st')) || {};
      const html = defaultChk.map((item, i) => {
        const chk = saved[i] ? 'checked' : '';
        const line = saved[i] ? 'line-through text-draw-muted' : 'text-draw-ink';
        return `
          <label class="flex items-center gap-3 p-3 border-b-2 border-dashed border-gray-200 last:border-0 cursor-pointer hover:bg-gray-50 transition-colors">
            <input type="checkbox" onchange="toggleChk(${i}, this)" ${chk} class="w-5 h-5 accent-draw-green border-2 border-draw-ink rounded">
            <span id="chk-txt-${i}" class="${line} transition-colors">${item}</span>
          </label>`;
      }).join('');
      document.getElementById('checklist-box').innerHTML = html;
      
      const memo = localStorage.getItem('tk26_memo_st') || '';
      document.getElementById('memo-input').value = memo;
      renderMemo(memo);
    }

    function toggleChk(i, el) {
      const saved = JSON.parse(localStorage.getItem('tk26_chk_st')) || {};
      saved[i] = el.checked;
      localStorage.setItem('tk26_chk_st', JSON.stringify(saved));
      const txt = document.getElementById(`chk-txt-${i}`);
      if(el.checked) {
          txt.classList.add('line-through', 'text-draw-muted');
          txt.classList.remove('text-draw-ink');
      } else {
          txt.classList.remove('line-through', 'text-draw-muted');
          txt.classList.add('text-draw-ink');
      }
    }

    function saveMemo() {
      const memo = document.getElementById('memo-input').value;
      localStorage.setItem('tk26_memo_st', memo);
      renderMemo(memo);
      showToast('筆記已儲存 📝');
    }

    function renderMemo(text) {
      const div = document.getElementById('memo-display');
      if(!text.trim()) { div.classList.add('hidden'); return; }
      div.classList.remove('hidden');
      
      const safeText = text.replace(/</g, '<').replace(/>/g, '>');
      const urlRegex = /(https?:\/\/[^\s]+)/g;
      div.innerHTML = safeText.replace(urlRegex, function(url) {
          return `<a href="${url}" target="_blank" class="inline-block bg-draw-blue text-white px-3 py-1.5 rounded-lg border-2 border-draw-ink shadow-solid-sm my-1 text-[10px] click-effect font-black"><i class="fa-solid fa-link mr-1"></i> 前往連結</a>`;
      }).replace(/\n/g, '<br>');
    }

    // 初始化執行
    window.onload = () => {
      loadInfoSheet(); // 載入 INFO 裡的預訂快訊
      renderExp();
      initLists();
    };
  </script>
</body>
</html>
